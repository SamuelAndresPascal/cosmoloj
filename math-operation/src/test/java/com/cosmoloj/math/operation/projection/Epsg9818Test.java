package com.cosmoloj.math.operation.projection;

import com.cosmoloj.bibliography.cosmoloj.Cosmoloj;
import com.cosmoloj.math.operation.surface.Ellipsoid;
import com.cosmoloj.util.bib.Page;
import com.cosmoloj.util.bib.Reference;
import com.cosmoloj.util.bib.SectionReference;
import com.cosmoloj.util.bib.SectionReferenceType;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

/**
 *
 * @author Samuel Andr√©s
 */
@Reference(Cosmoloj.MAP_PROJECTIONS)
public class Epsg9818Test {

    private final Epsg9818 transform = new Epsg9818(Ellipsoid.ofSemiMinorAxis(6378206.4, 6356583.8), 0., 0., 0., 0.);

    @Test
    public void forward() {

        for (int i = 0; i < RESULTS.length; i++) {
            for (int j = 0; j < RESULTS[i].length; j++) {
                Assertions.assertArrayEquals(RESULTS[i][j],
                        transform.compute(new double[]{Math.toRadians(50 - i), Math.toRadians(j)}), 1.);
            }
        }
    }

    @Test
    public void inverse() {

        for (int i = 0; i < RESULTS.length; i++) {
            for (int j = 0; j < RESULTS[i].length; j++) {
                Assertions.assertArrayEquals(new double[]{Math.toRadians(50 - i), Math.toRadians(j)},
                        transform.inverse(RESULTS[i][j]), 1e-7);
            }
        }
    }

    @SectionReference(type = SectionReferenceType.TABLE, number = 19)
    @Page(132)
    private static final double[][][] RESULTS = {
        {{0., 5540628.}, {71696., 5541107.}, {143379., 5542545.}, {215037., 5544941.}},
        {{0., 5429409.}, {73172., 5429890.}, {146331., 5431336.}, {219465., 5433745.}},
        {{0., 5318209.}, {74626., 5318693.}, {149239., 5320144.}, {223827., 5322564.}},
        {{0., 5207028.}, {76056., 5207514.}, {152100., 5208970.}, {228119., 5211397.}},
        {{0., 5095868.}, {77464., 5096354.}, {154915., 5097813.}, {232342., 5100244.}},
        {{0., 4984727.}, {78847., 4985214.}, {157682., 4986673.}, {236493., 4989106.}},
        {{0., 4873606.}, {80207., 4874092.}, {160401., 4875551.}, {240572., 4877982.}},
        {{0., 4762505.}, {81541., 4762990.}, {163071., 4764446.}, {244578., 4766872.}},
        {{0., 4651423.}, {82851., 4651907.}, {165691., 4653358.}, {248508., 4655777.}},
        {{0., 4540361.}, {84136., 4540843.}, {168260., 4542288.}, {252363., 4544696.}},
        {{0., 4429319.}, {85394., 4429798.}, {170778., 4431235.}, {256140., 4433630.}},
        {{0., 4318296.}, {86627., 4318772.}, {173243., 4320199.}, {259839., 4322577.}},
        {{0., 4207292.}, {87833., 4207764.}, {175656., 4209180.}, {263458., 4211539.}},
        {{0., 4096308.}, {89012., 4096775.}, {178015., 4098178.}, {266997., 4100515.}},
        {{0., 3985342.}, {90164., 3985805.}, {180319., 3987192.}, {270455., 3989504.}},
        {{0., 3874395.}, {91289., 3874852.}, {182568., 3876223.}, {273830., 3878507.}},
        {{0., 3763467.}, {92385., 3763918.}, {184762., 3765270.}, {277121., 3767524.}},
        {{0., 3652557.}, {93454., 3653001.}, {186899., 3654333.}, {280328., 3656554.}},
        {{0., 3541665.}, {94494., 3542102.}, {188980., 3543413.}, {283449., 3545597.}},
        {{0., 3430790.}, {95505., 3431220.}, {191002., 3432507.}, {286484., 3434653.}},
        {{0., 3319933.}, {96487., 3320354.}, {192967., 3321617.}, {289432., 3323722.}},
        {{0., 3209093.}, {97440., 3209506.}, {194872., 3210742.}, {292291., 3212803.}},
        {{0., 3098270.}, {98363., 3098673.}, {196719., 3099882.}, {295062., 3101897.}},
        {{0., 2987463.}, {99256., 2987856.}, {198505., 2989036.}, {297742., 2991002.}},
        {{0., 2876672.}, {100119., 2877055.}, {200231., 2878204.}, {300332., 2880119.}},
        {{0., 2765896.}, {100951., 2766269.}, {201896., 2767386.}, {302831., 2769247.}},
        {{0., 2655136.}, {101753., 2655497.}, {203500., 2656580.}, {305237., 2658386.}},
        {{0., 2544390.}, {102523., 2544739.}, {205042., 2545788.}, {307551., 2547536.}}
    };
}
